# Подписка на обновления

```
POST /subscriptions
```

Подписывает бота на получение обновлений через WebHook. После вызова этого метода бот будет получать уведомления о новых событиях в чатах на указанный URL.

> Ваш сервер должен прослушивать один из следующих портов: 80, 8080, 443, 8443, 16384-32383

## Пример запроса

```bash
curl -X POST "https://platform-api.max.ru/subscriptions" \
  -H "Authorization: {access_token}" \
  -H "Content-Type: application/json" \
  -d '{
    "url": "https://your-domain.com/webhook",
    "update_types": ["message_created", "bot_started"],
    "secret": "your_secret"
  }'
```

---

## Авторизация

- **access_token** (apiKey)

> Передача токена через query-параметры больше не поддерживается — используйте заголовок `Authorization: <token>`

Токен для вызова HTTP-запросов присваивается при создании бота — его можно найти в разделе платформы MAX для партнёров «Интеграция» → «Получить токен».

> Рекомендуем не разглашать токен посторонним, чтобы они не получили доступ к управлению ботом. Токен может быть отозван за нарушение Правил платформы.

---

## Тело запроса

| Параметр | Тип | Описание |
|----------|-----|----------|
| **url** | string | URL HTTP(S)-эндпойнта вашего бота. Должен начинаться с `http(s)://` |
| **update_types** | string[] optional | Пример: `["message_created", "bot_started"]`. Список типов обновлений, которые ваш бот хочет получать. Для полного списка типов см. объект [Update](../02_Объекты/Update.md). |
| **secret** | string optional `^[a-zA-Z0-9_-]{5,256}$` | от 5 до 256 символов. Секрет, который должен быть отправлен в заголовке `X-Max-Bot-Api-Secret` в каждом запросе Webhook. Разрешены только символы A-Z, a-z, 0-9, и дефис. Заголовок рекомендован, чтобы запрос поступал из установленного веб-узла. |

---

## Результат

| Поле | Тип | Описание |
|------|-----|----------|
| **success** | boolean | `true`, если запрос был успешным, `false` в противном случае |
| **message** | string optional | Объяснительное сообщение, если результат не был успешным |
